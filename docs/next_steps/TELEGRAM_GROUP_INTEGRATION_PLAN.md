# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram –≥—Ä—É–ø–ø–∞–º–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–æ–≤

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-12-19
**–°—Ç–∞—Ç—É—Å:** üîµ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–¶–µ–ª—å:** –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª—É–±–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö Telegram –≥—Ä—É–ø–ø

**–°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
1. –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç –±–æ—Ç–∞ –≤ Telegram –≥—Ä—É–ø–ø—É –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É `/create_club` –≤ –≥—Ä—É–ø–ø–µ
3. –ë–æ—Ç –ø–∞—Ä—Å–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–µ
4. –ë–æ—Ç —Å–æ–∑–¥–∞–µ—Ç –∫–ª—É–± –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ø–∞—Ä—Å–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
5. –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ —Å—Å—ã–ª–∫—É –Ω–∞ –∫–ª—É–± –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P1 (–≤–∞–∂–Ω–æ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤)

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° –ì–†–£–ü–ü–ê–ú–ò                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ  1. Group Info Parser                                       ‚îÇ
‚îÇ     - –ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã                                       ‚îÇ
‚îÇ     - –û–ø–∏—Å–∞–Ω–∏–µ (–∏–∑ chat.description)                        ‚îÇ
‚îÇ     - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–∏–∑ chat.member_count)          ‚îÇ
‚îÇ     - Username –≥—Ä—É–ø–ø—ã (@groupname)                          ‚îÇ
‚îÇ     - Invite link                                           ‚îÇ
‚îÇ     - –ê–≤–∞—Ç–∞—Ä –≥—Ä—É–ø–ø—ã                                         ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  2. Admin Verification                                      ‚îÇ
‚îÇ     - –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –±–æ—Ç —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–æ–º                    ‚îÇ
‚îÇ     - –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–æ–º/creator   ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  3. Club Creation Handler                                   ‚îÇ
‚îÇ     - –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—É–±–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø—ã                ‚îÇ
‚îÇ     - –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –∫–ª—É–±–∞ —Å Telegram –≥—Ä—É–ø–ø–æ–π                   ‚îÇ
‚îÇ     - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—è –∫–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞                 ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  4. Permissions & Settings                                  ‚îÇ
‚îÇ     - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø—Ä–∞–≤ –±–æ—Ç–∞                        ‚îÇ
‚îÇ     - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –≥—Ä—É–ø–ø–µ                        ‚îÇ
‚îÇ                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –§–∞–∑—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### üìã –§–ê–ó–ê 1: Group Info Parser –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

**–¶–µ–ª—å:** –ü–æ–ª—É—á–∏—Ç—å –≤—Å—é –¥–æ—Å—Ç—É–ø–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞

#### Task 1.1: –°–æ–∑–¥–∞—Ç—å Group Info Parser

**–§–∞–π–ª:** `bot/group_parser.py`

```python
class TelegramGroupParser:
    """
    –ü–∞—Ä—Å–µ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ Telegram –≥—Ä—É–ø–ø–µ

    –ò–∑–≤–ª–µ–∫–∞–µ—Ç:
    - –ë–∞–∑–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, username)
    - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤)
    - –ú–µ–¥–∏–∞ (–∞–≤–∞—Ç–∞—Ä –≥—Ä—É–ø–ø—ã)
    - –°—Å—ã–ª–∫–∏ (invite link)
    """

    async def parse_group_info(self, chat_id: int, bot: Bot) -> dict:
        """
        –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–µ

        Returns:
            {
                'chat_id': int,
                'title': str,
                'description': str,
                'username': str,  # @groupname
                'member_count': int,
                'invite_link': str,
                'photo': str,  # file_id –∞–≤–∞—Ç–∞—Ä–∞
                'type': str,  # 'group' –∏–ª–∏ 'supergroup'
            }
        """
        pass

    async def get_group_photo(self, chat_id: int, bot: Bot) -> Optional[str]:
        """–ü–æ–ª—É—á–∏—Ç—å file_id –∞–≤–∞—Ç–∞—Ä–∞ –≥—Ä—É–ø–ø—ã"""
        pass

    async def get_member_count(self, chat_id: int, bot: Bot) -> int:
        """–ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤"""
        pass

    async def get_invite_link(self, chat_id: int, bot: Bot) -> Optional[str]:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å invite link"""
        pass
```

**–ß—Ç–æ –ø–∞—Ä—Å–∏–º:**

| –î–∞–Ω–Ω—ã–µ | Telegram API | –ú–∞–ø–ø–∏–Ω–≥ –≤ Club |
|--------|--------------|----------------|
| –ù–∞–∑–≤–∞–Ω–∏–µ | `chat.title` | `club.name` |
| –û–ø–∏—Å–∞–Ω–∏–µ | `chat.description` | `club.description` |
| Username | `chat.username` | `club.username` |
| –£—á–∞—Å—Ç–Ω–∏–∫–∏ | `chat.get_member_count()` | –î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ |
| Invite link | `chat.invite_link` –∏–ª–∏ `export_chat_invite_link()` | `club.invite_link` |
| –ê–≤–∞—Ç–∞—Ä | `chat.photo.big_file_id` | `club.photo` |
| Chat ID | `chat.id` | `club.telegram_chat_id` |

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

#### Task 1.2: –°–æ–∑–¥–∞—Ç—å Admin Verification

**–§–∞–π–ª:** `bot/group_parser.py` (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)

```python
class TelegramGroupParser:

    async def verify_bot_is_admin(self, chat_id: int, bot: Bot) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±–æ—Ç —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –≥—Ä—É–ø–ø—ã

        –¢—Ä–µ–±—É–µ–º—ã–µ –ø—Ä–∞–≤–∞:
        - can_invite_users (–¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è invite links)
        - can_read_messages (–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
        """
        pass

    async def verify_user_is_admin(self, chat_id: int, user_id: int, bot: Bot) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –∏–ª–∏ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º
        """
        pass

    async def get_user_status(self, chat_id: int, user_id: int, bot: Bot) -> str:
        """
        –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø–µ

        Returns: 'creator', 'administrator', 'member', 'restricted', 'left', 'kicked'
        """
        pass
```

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

### üì¶ –§–ê–ó–ê 2: Club Creation Handler

**–¶–µ–ª—å:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã `/create_club` –≤ –≥—Ä—É–ø–ø–µ

#### Task 2.1: –°–æ–∑–¥–∞—Ç—å handler –¥–ª—è –∫–æ–º–∞–Ω–¥—ã `/create_club`

**–§–∞–π–ª:** `bot/group_integration_handler.py`

```python
async def create_club_from_group(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """
    Handler –¥–ª—è –∫–æ–º–∞–Ω–¥—ã /create_club –≤ –≥—Ä—É–ø–ø–µ

    Flow:
    1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –≤—ã–∑–≤–∞–Ω–∞ –≤ –≥—Ä—É–ø–ø–µ (–Ω–µ –≤ –õ–°)
    2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - –∞–¥–º–∏–Ω/—Å–æ–∑–¥–∞—Ç–µ–ª—å –≥—Ä—É–ø–ø—ã
    3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±–æ—Ç - –∞–¥–º–∏–Ω –≥—Ä—É–ø–ø—ã
    4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≥—Ä—É–ø–ø–∞ –µ—â–µ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–ª—É–±–æ–º
    5. –°–ø–∞—Ä—Å–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–µ
    6. –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–≤—å—é –∫–ª—É–±–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    7. –ó–∞–ø—Ä–æ—Å–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
    8. –°–æ–∑–¥–∞—Ç—å –∫–ª—É–±
    9. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    """
    pass
```

**States –¥–ª—è ConversationHandler:**

```python
# States
CONFIRMING_CLUB_CREATION = 1
EDITING_CLUB_DATA = 2
SELECTING_SPORTS = 3
FINALIZING = 4
```

**–ü—Ä–∏–º–µ—Ä flow:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /create_club

–ë–æ—Ç:
üìã –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—É–±–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥—Ä—É–ø–ø—ã "Trail Runners Moscow"

–Ø –Ω–∞—à–µ–ª —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:
‚ñ™Ô∏è –ù–∞–∑–≤–∞–Ω–∏–µ: Trail Runners Moscow
‚ñ™Ô∏è –û–ø–∏—Å–∞–Ω–∏–µ: –ö–ª—É–± –ª—é–±–∏—Ç–µ–ª–µ–π —Ç—Ä–µ–π–ª—Ä–∞–Ω–Ω–∏–Ω–≥–∞ –≤ –ú–æ—Å–∫–≤–µ
‚ñ™Ô∏è –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: 127
‚ñ™Ô∏è –ì—Ä—É–ø–ø–∞: @trailrunmoscow

–•–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∫–ª—É–± —Å —ç—Ç–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏?
[–ö–Ω–æ–ø–∫–∏: ‚úÖ –°–æ–∑–¥–∞—Ç—å | ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å | ‚ùå –û—Ç–º–µ–Ω–∏—Ç—å]

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ‚úÖ –°–æ–∑–¥–∞—Ç—å

–ë–æ—Ç:
–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞ –¥–ª—è –∫–ª—É–±–∞:
[–ö–Ω–æ–ø–∫–∏: –ë–µ–≥ | –¢—Ä–µ–π–ª | –õ—ã–∂–∏ | ... | –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å]

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –¢—Ä–µ–π–ª, –ë–µ–≥ ‚Üí –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å

–ë–æ—Ç:
‚úÖ –ö–ª—É–± "Trail Runners Moscow" —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!

üîó –°—Å—ã–ª–∫–∞: https://aydarun.app/clubs/abc-123
üë§ –í—ã –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–º –∫–ª—É–±–∞

–¢–µ–ø–µ—Ä—å —É—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã –º–æ–≥—É—Ç –≤—Å—Ç—É–ø–∏—Ç—å –≤ –∫–ª—É–± —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
```

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

#### Task 2.2: –°–æ–∑–¥–∞—Ç—å Preview –∏ Confirmation

**–§–∞–π–ª:** `bot/group_integration_handler.py`

```python
async def show_club_preview(
    update: Update,
    context: ContextTypes.DEFAULT_TYPE,
    group_data: dict
) -> int:
    """
    –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–≤—å—é –±—É–¥—É—â–µ–≥–æ –∫–ª—É–±–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø—ã
    """
    pass

async def handle_club_confirmation(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    """
    –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–∞
    """
    pass

async def handle_edit_club_data(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    """
    –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–ª—É–±–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º
    –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å:
    - –ù–∞–∑–≤–∞–Ω–∏–µ
    - –û–ø–∏—Å–∞–Ω–∏–µ
    - –í–∏–¥—ã —Å–ø–æ—Ä—Ç–∞
    """
    pass
```

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

#### Task 2.3: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—É–±–∞ –≤ –ë–î

**–§–∞–π–ª:** `storage/club_storage.py` (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)

```python
class ClubStorage:

    def create_club_from_telegram_group(
        self,
        creator_id: str,
        group_data: dict,
        sports: List[str]
    ) -> Club:
        """
        –°–æ–∑–¥–∞—Ç—å –∫–ª—É–± –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö Telegram –≥—Ä—É–ø–ø—ã

        Args:
            creator_id: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-—Å–æ–∑–¥–∞—Ç–µ–ª—è
            group_data: –î–∞–Ω–Ω—ã–µ –∏–∑ TelegramGroupParser
            sports: –í—ã–±—Ä–∞–Ω–Ω—ã–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞

        Returns:
            Club: –°–æ–∑–¥–∞–Ω–Ω—ã–π –∫–ª—É–±

        Raises:
            ValueError: –ï—Å–ª–∏ –≥—Ä—É–ø–ø–∞ —É–∂–µ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–ª—É–±–æ–º
        """
        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≥—Ä—É–ø–ø–∞ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –¥—Ä—É–≥–∏–º –∫–ª—É–±–æ–º
        existing_club = self.get_club_by_telegram_chat_id(group_data['chat_id'])
        if existing_club:
            raise ValueError(f"–ì—Ä—É–ø–ø–∞ —É–∂–µ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–ª—É–±–æ–º {existing_club.name}")

        # –°–æ–∑–¥–∞—Ç—å –∫–ª—É–±
        club = Club(
            name=group_data['title'],
            description=group_data.get('description'),
            creator_id=creator_id,
            username=group_data.get('username'),
            telegram_chat_id=group_data['chat_id'],
            invite_link=group_data.get('invite_link'),
            photo=group_data.get('photo'),
            # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
        )

        # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å sports –≤ JSON
        # –î–æ–±–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞—Ç–µ–ª—è –∫–∞–∫ ORGANIZER
        # ...

        return club

    def get_club_by_telegram_chat_id(self, chat_id: int) -> Optional[Club]:
        """–ü–æ–ª—É—á–∏—Ç—å –∫–ª—É–± –ø–æ telegram_chat_id"""
        pass
```

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

### üîî –§–ê–ó–ê 3: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è

#### Task 3.1: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–∞

**–§–∞–π–ª:** `bot/group_integration_handler.py`

```python
async def send_club_created_notification_to_group(
    chat_id: int,
    club: Club,
    bot: Bot
) -> None:
    """
    –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª—É–±–∞

    –°–æ–æ–±—â–µ–Ω–∏–µ:
    - –ö–ª—É–± —Å–æ–∑–¥–∞–Ω
    - –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–ª—É–± –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
    - –ü—Ä–∏–∑—ã–≤ –≤—Å—Ç—É–ø–∏—Ç—å
    - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ
    """
    pass

async def send_club_created_notification_to_organizer(
    user_id: int,
    club: Club,
    bot: Bot
) -> None:
    """
    –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—É –≤ –õ–°

    –°–æ–æ–±—â–µ–Ω–∏–µ:
    - –ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ
    - –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–ª—É–±
    - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é
    - Invite link –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
    """
    pass
```

**–ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É:**

```
üéâ –ö–ª—É–± —Å–æ–∑–¥–∞–Ω –≤ Ayda Run!

–¢–µ–ø–µ—Ä—å "Trail Runners Moscow" –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Ayda Run!

üîó –í—Å—Ç—É–ø–∏—Ç—å –≤ –∫–ª—É–±: https://aydarun.app/clubs/abc-123

–ß—Ç–æ –¥–∞–µ—Ç –≤–∞–º –∫–ª—É–±:
‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
‚úÖ –£—á–∞—Å—Ç–∏–µ –≤ –∑–∞–±–µ–≥–∞—Ö
‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
‚úÖ –û–±—â–µ–Ω–∏–µ —Å –±–µ–≥—É–Ω–∞–º–∏

–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: [–ö–Ω–æ–ø–∫–∞ WebApp]
```

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

#### Task 3.2: –î–æ–±–∞–≤–∏—Ç—å deep link –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è

**–§–∞–π–ª:** `bot/group_integration_handler.py`

```python
def generate_club_join_link(club_id: str, bot_username: str) -> str:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å deep link –¥–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –∫–ª—É–±

    Returns: https://t.me/yourbot?start=club_<UUID>
    """
    return f"https://t.me/{bot_username}?start=club_{club_id}"
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –í —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏ –≤ –≥—Ä—É–ø–ø—É –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É —Å deep link
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∫–ª–∏–∫–∞—é—Ç –∏ —Å—Ä–∞–∑—É –≤—Å—Ç—É–ø–∞—é—Ç –≤ –∫–ª—É–± (Flow 2A)

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

### ‚úÖ –§–ê–ó–ê 4: –ü—Ä–æ–≤–µ—Ä–∫–∏ –∏ edge cases

#### Task 4.1: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ edge cases

**–°—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:**

1. **–ë–æ—Ç –Ω–µ –∞–¥–º–∏–Ω –≥—Ä—É–ø–ø—ã**
   ```
   ‚ùå –û—à–∏–±–∫–∞: –Ø –Ω–µ —è–≤–ª—è—é—Å—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –≥—Ä—É–ø–ø—ã

   –ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –∫–ª—É–±, –¥–æ–±–∞–≤—å—Ç–µ –º–µ–Ω—è –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å –ø—Ä–∞–≤–∞–º–∏:
   - –ü—Ä–∏–≥–ª–∞—à–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ß–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
   ```

2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–¥–º–∏–Ω –≥—Ä—É–ø–ø—ã**
   ```
   ‚ùå –û—à–∏–±–∫–∞: –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–∞

   –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –∏ —Å–æ–∑–¥–∞—Ç–µ–ª—å –≥—Ä—É–ø–ø—ã –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–ª—É–±—ã.
   ```

3. **–ì—Ä—É–ø–ø–∞ —É–∂–µ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–ª—É–±–æ–º**
   ```
   ‚ùå –ì—Ä—É–ø–ø–∞ —É–∂–µ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–ª—É–±–æ–º "Trail Runners Moscow"

   üîó –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–ª—É–±: https://aydarun.app/clubs/abc-123
   ```

4. **–ö–æ–º–∞–Ω–¥–∞ –≤—ã–∑–≤–∞–Ω–∞ –≤ –õ–°, –∞ –Ω–µ –≤ –≥—Ä—É–ø–ø–µ**
   ```
   ‚ÑπÔ∏è –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –≥—Ä—É–ø–ø–∞—Ö

   –î–æ–±–∞–≤—å—Ç–µ –º–µ–Ω—è –≤ –≥—Ä—É–ø–ø—É –∏ –≤—ã–∑–æ–≤–∏—Ç–µ /create_club —Ç–∞–º.
   ```

5. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≥—Ä—É–ø–ø–µ**
   ```
   ‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–µ

   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
   - –ì—Ä—É–ø–ø–∞ —è–≤–ª—è–µ—Ç—Å—è —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–æ–π
   - –£ –±–æ—Ç–∞ –µ—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞
   ```

**–§–∞–π–ª:** `bot/group_integration_handler.py`

```python
class GroupIntegrationError(Exception):
    """–ë–∞–∑–æ–≤–∞—è –æ—à–∏–±–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≥—Ä—É–ø–ø–æ–π"""
    pass

class BotNotAdminError(GroupIntegrationError):
    """–ë–æ—Ç –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º"""
    pass

class UserNotAdminError(GroupIntegrationError):
    """–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º"""
    pass

class GroupAlreadyLinkedError(GroupIntegrationError):
    """–ì—Ä—É–ø–ø–∞ —É–∂–µ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–ª—É–±–æ–º"""
    pass

class NotInGroupError(GroupIntegrationError):
    """–ö–æ–º–∞–Ω–¥–∞ –≤—ã–∑–≤–∞–Ω–∞ –Ω–µ –≤ –≥—Ä—É–ø–ø–µ"""
    pass
```

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

#### Task 4.2: –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø—ã

**–§–∞–π–ª:** `bot/validators.py` (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)

```python
def validate_group_data(group_data: dict) -> tuple[bool, str]:
    """
    –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø—ã –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∫–ª—É–±–∞

    –ü—Ä–æ–≤–µ—Ä–∫–∏:
    - –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–µ –ø—É—Å—Ç–æ–µ –∏ –Ω–µ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ
    - Chat ID –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
    - –¢–∏–ø —á–∞—Ç–∞ - –≥—Ä—É–ø–ø–∞ –∏–ª–∏ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–∞
    """
    if not group_data.get('title'):
        return False, "–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"

    if len(group_data['title']) < 3:
        return False, "–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ"

    if group_data.get('type') not in ['group', 'supergroup']:
        return False, "–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —á–∞—Ç–∞"

    return True, "OK"
```

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

### üß™ –§–ê–ó–ê 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### Task 5.1: Unit —Ç–µ—Å—Ç—ã

**–§–∞–π–ª:** `tests/test_bot/test_group_integration.py`

```python
class TestGroupParser:
    """–¢–µ—Å—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≥—Ä—É–ø–ø–µ"""

    def test_parse_group_info(self):
        """–¢–µ—Å—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"""
        pass

    def test_verify_bot_is_admin(self):
        """–¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –±–æ—Ç–∞"""
        pass

    def test_verify_user_is_admin(self):
        """–¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        pass

class TestClubCreationFromGroup:
    """–¢–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–∞ –∏–∑ –≥—Ä—É–ø–ø—ã"""

    def test_create_club_from_group_success(self):
        """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–∞"""
        pass

    def test_create_club_group_already_linked(self):
        """–¢–µ—Å—Ç –ø–æ–ø—ã—Ç–∫–∏ —Å–æ–∑–¥–∞—Ç—å –∫–ª—É–± –¥–ª—è —É–∂–µ —Å–≤—è–∑–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã"""
        pass

    def test_create_club_bot_not_admin(self):
        """–¢–µ—Å—Ç –∫–æ–≥–¥–∞ –±–æ—Ç –Ω–µ –∞–¥–º–∏–Ω"""
        pass

class TestGroupIntegrationErrors:
    """–¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫"""

    def test_not_in_group_error(self):
        pass

    def test_user_not_admin_error(self):
        pass
```

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

#### Task 5.2: Integration —Ç–µ—Å—Ç—ã

**–°—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

1. **Happy path**: –ê–¥–º–∏–Ω –≥—Ä—É–ø–ø—ã —Å–æ–∑–¥–∞–µ—Ç –∫–ª—É–±
2. **Edge case**: –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –≤—Ç–æ—Ä–æ–π –∫–ª—É–± –¥–ª—è —Ç–æ–π –∂–µ –≥—Ä—É–ø–ø—ã
3. **Error handling**: –ë–æ—Ç –Ω–µ –∞–¥–º–∏–Ω
4. **Error handling**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–¥–º–∏–Ω
5. **Validation**: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

### üìö –§–ê–ó–ê 6: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### Task 6.1: –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

**–§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**

1. **`docs/bot/GROUP_INTEGRATION.md`** (–Ω–æ–≤—ã–π)
   - –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
   - –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –≥—Ä—É–ø–ø
   - –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞
   - FAQ –∏ troubleshooting

2. **`docs/bot/ONBOARDING.md`** (–¥–æ–ø–æ–ª–Ω–∏—Ç—å)
   - –î–æ–±–∞–≤–∏—Ç—å Flow 4: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—É–±–∞ –∏–∑ –≥—Ä—É–ø–ø—ã

3. **`README.md`** (–æ–±–Ω–æ–≤–∏—Ç—å)
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ group integration

**–°—Ç–∞—Ç—É—Å:** ‚¨ú –ù–µ –Ω–∞—á–∞—Ç–æ

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü—Ä–∞–≤–∞ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:**

| –ü—Ä–∞–≤–æ | –ó–∞—á–µ–º –Ω—É–∂–Ω–æ |
|-------|-------------|
| `can_read_messages` | –ü–æ–ª—É—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–µ |
| `can_invite_users` | –°–æ–∑–¥–∞–≤–∞—Ç—å invite links |
| `can_delete_messages` | –£–¥–∞–ª—è—Ç—å spam (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `can_restrict_members` | –ú–æ–¥–µ—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

### Telegram API –º–µ—Ç–æ–¥—ã

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —á–∞—Ç–µ
chat = await bot.get_chat(chat_id)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
member_count = await bot.get_chat_member_count(chat_id)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
member = await bot.get_chat_member(chat_id, user_id)

# –°–æ–∑–¥–∞–Ω–∏–µ invite link
invite_link = await bot.export_chat_invite_link(chat_id)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ –≥—Ä—É–ø–ø—ã
photos = await bot.get_user_profile_photos(chat_id)
```

### –°–≤—è–∑—å Club ‚Üî Telegram Group

**–í –º–æ–¥–µ–ª–∏ Club —É–∂–µ –µ—Å—Ç—å:**
```python
telegram_chat_id = Column(Integer, nullable=True)  # Telegram chat ID –≥—Ä—É–ø–ø—ã
invite_link = Column(String(500), nullable=True)   # Invite link –≥—Ä—É–ø–ø—ã
username = Column(String(255), nullable=True)      # @groupname
photo = Column(String(255), nullable=True)         # Avatar file_id
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è:**
```python
# –í –º–æ–¥–µ–ª–∏ Club
is_auto_created = Column(Boolean, default=False)  # –°–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –≥—Ä—É–ø–ø—ã
telegram_group_synced_at = Column(DateTime)       # –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```

---

## –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç –∑–∞–¥–∞—á

### ‚úÖ –§–∞–∑–∞ 1: Group Info Parser
- [ ] –°–æ–∑–¥–∞—Ç—å TelegramGroupParser class
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å parse_group_info()
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å verify_bot_is_admin()
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å verify_user_is_admin()
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ –≥—Ä—É–ø–ø—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ invite link

### ‚úÖ –§–∞–∑–∞ 2: Club Creation Handler
- [ ] –°–æ–∑–¥–∞—Ç—å group_integration_handler.py
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å create_club_from_group command handler
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å show_club_preview()
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å handle_club_confirmation()
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å handle_edit_club_data()
- [ ] –î–æ–±–∞–≤–∏—Ç—å sports selection –¥–ª—è –≥—Ä—É–ø–ø—ã
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç—å ClubStorage.create_club_from_telegram_group()
- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å handler –≤ api_server.py

### ‚úÖ –§–∞–∑–∞ 3: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å send_club_created_notification_to_group()
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å send_club_created_notification_to_organizer()
- [ ] –î–æ–±–∞–≤–∏—Ç—å generate_club_join_link()
- [ ] –°–æ–∑–¥–∞—Ç—å keyboards –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç–µ–∫—Å—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π

### ‚úÖ –§–∞–∑–∞ 4: –ü—Ä–æ–≤–µ—Ä–∫–∏ –∏ edge cases
- [ ] –°–æ–∑–¥–∞—Ç—å custom exceptions
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É BotNotAdminError
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É UserNotAdminError
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É GroupAlreadyLinkedError
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É NotInGroupError
- [ ] –î–æ–±–∞–≤–∏—Ç—å validate_group_data()

### ‚úÖ –§–∞–∑–∞ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –°–æ–∑–¥–∞—Ç—å tests/test_bot/test_group_integration.py
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è TelegramGroupParser
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å integration —Ç–µ—Å—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—É–±–∞
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è error handling
- [ ] –ü—Ä–æ–≤–µ—Å—Ç–∏ manual testing –≤ —Ä–µ–∞–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–µ

### ‚úÖ –§–∞–∑–∞ 6: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –°–æ–∑–¥–∞—Ç—å docs/bot/GROUP_INTEGRATION.md
- [ ] –û–±–Ω–æ–≤–∏—Ç—å docs/bot/ONBOARDING.md
- [ ] –û–±–Ω–æ–≤–∏—Ç—å README.md
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## –û—Ü–µ–Ω–∫–∞ —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç

| –§–∞–∑–∞ | –ó–∞–¥–∞—á–∏ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –í—Ä–µ–º—è |
|------|--------|-----------|-----------|-------|
| –§–∞–∑–∞ 1 | Group Parser | P0 | Medium | 3-4 —á–∞—Å–∞ |
| –§–∞–∑–∞ 2 | Club Creation | P0 | High | 4-5 —á–∞—Å–æ–≤ |
| –§–∞–∑–∞ 3 | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è | P1 | Low | 2-3 —á–∞—Å–∞ |
| –§–∞–∑–∞ 4 | Edge Cases | P0 | Medium | 2-3 —á–∞—Å–∞ |
| –§–∞–∑–∞ 5 | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | P1 | Medium | 3-4 —á–∞—Å–∞ |
| –§–∞–∑–∞ 6 | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | P2 | Low | 1-2 —á–∞—Å–∞ |

**–ò—Ç–æ–≥–æ:** 15-21 —á–∞—Å

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Ä–∏—Å–∫–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- ‚úÖ python-telegram-bot –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥–µ–ª–∏ –ë–î (Club, User, Membership)
- ‚úÖ Onboarding flow (Flow 1-3)
- ‚ö†Ô∏è –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–¥–º–∏–Ω–æ–º –≥—Ä—É–ø–ø—ã

**–†–∏—Å–∫–∏:**

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|-------------|-----------|
| –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞ | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –ß–µ—Ç–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é |
| API rate limits Telegram | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, retry –ª–æ–≥–∏–∫–∞ |
| –ì—Ä—É–ø–ø–∞ —É–¥–∞–ª–µ–Ω–∞/–±–æ—Ç –∫–∏–∫–Ω—É—Ç | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ |
| –ö–æ–Ω—Ñ–ª–∏–∫—Ç –Ω–∞–∑–≤–∞–Ω–∏–π –∫–ª—É–±–æ–≤ | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–æ–µ | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—É—Ñ—Ñ–∏–∫—Å–∞ –ø—Ä–∏ –¥—É–±–ª–µ |

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—É–±–∞ –∏–∑ –≥—Ä—É–ø–ø—ã

```
# –í –≥—Ä—É–ø–ø–µ Trail Runners Moscow

–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä: /create_club

–ë–æ—Ç:
üìã –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—É–±–∞ "Trail Runners Moscow"

–ù–∞–π–¥–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
‚ñ™Ô∏è –ù–∞–∑–≤–∞–Ω–∏–µ: Trail Runners Moscow
‚ñ™Ô∏è –û–ø–∏—Å–∞–Ω–∏–µ: –ö–ª—É–± –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π —Ç—Ä–µ–π–ª—Ä–∞–Ω–Ω–∏–Ω–≥–∞
‚ñ™Ô∏è –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: 127
‚ñ™Ô∏è –ì—Ä—É–ø–ø–∞: @trailrunmoscow

[‚úÖ –°–æ–∑–¥–∞—Ç—å | ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å | ‚ùå –û—Ç–º–µ–Ω–∏—Ç—å]

–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä: ‚úÖ –°–æ–∑–¥–∞—Ç—å

–ë–æ—Ç:
–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞:
[–ë–µ–≥ | –¢—Ä–µ–π–ª ‚úì | –õ—ã–∂–∏ | –í–µ–ª–æ—Å–∏–ø–µ–¥ | –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å ‚Üí]

–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä: –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å ‚Üí

–ë–æ—Ç (–≤ –≥—Ä—É–ø–ø—É):
üéâ –ö–ª—É–± "Trail Runners Moscow" —Å–æ–∑–¥–∞–Ω!

–í—Å—Ç—É–ø–∏—Ç—å: https://t.me/yourbot?start=club_abc123
–ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: [WebApp Button]

–ë–æ—Ç (–≤ –õ–° –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—É):
‚úÖ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ö–ª—É–± "Trail Runners Moscow" —Å–æ–∑–¥–∞–Ω.

–í—ã –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–º –∫–ª—É–±–∞.

üîó –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—É–±–æ–º: https://aydarun.app/clubs/abc-123
üì≤ Invite link: https://t.me/yourbot?start=club_abc123

–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π –≤ –≥—Ä—É–ø–ø–µ, —á—Ç–æ–±—ã —É—á–∞—Å—Ç–Ω–∏–∫–∏ –º–æ–≥–ª–∏ –≤—Å—Ç—É–ø–∏—Ç—å!
```

---

## –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```mermaid
sequenceDiagram
    participant U as –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä
    participant TG as Telegram Group
    participant B as Bot
    participant DB as Database
    participant APP as Ayda Run App

    U->>TG: /create_club
    TG->>B: Command received

    B->>TG: get_chat() - –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ
    TG-->>B: chat data

    B->>TG: get_chat_member(user_id) - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
    TG-->>B: user is admin

    B->>TG: get_chat_member(bot_id) - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
    TG-->>B: bot is admin

    B->>DB: check if group already linked
    DB-->>B: no existing club

    B->>U: Show preview + confirmation
    U->>B: ‚úÖ Confirm

    B->>U: Select sports
    U->>B: Sports selected

    B->>DB: create_club_from_telegram_group()
    DB-->>B: club created

    B->>DB: add_member(user_id, ORGANIZER)

    B->>TG: Send notification to group
    B->>U: Send notification to user (DM)

    U->>APP: Open club link
```

---

**–°—Ç–∞—Ç—É—Å:** üìã **–ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å —Å –§–∞–∑—ã 1 - —Å–æ–∑–¥–∞–Ω–∏–µ Group Parser
