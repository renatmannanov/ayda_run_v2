# Implementation Plan - Ayda Run v2

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2025-12-18
**–°—Ç–∞—Ç—É—Å:** Active Development

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏

### P0 - –ö—Ä–∏—Ç–∏—á–Ω–æ (Must Have)

#### 1. Telegram Bot Onboarding ü§ñ
**–°—Ç–∞—Ç—É—Å:** Not Started
**–û–ø–∏—Å–∞–Ω–∏–µ:** –û–Ω–±–æ—Ä–¥–∏–Ω–≥ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ (—Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç)

**User Flow:**
1. `/start` ‚Üí –±–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ—Å—Ç—å –ª–∏ user –≤ –ë–î
2. –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –≤—ã–±—Ä–∞—Ç—å –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)
4. –ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `preferred_sports`, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `city = "Almaty"`
5. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É WebApp "üèÉ –û—Ç–∫—Ä—ã—Ç—å Ayda Run"

**Invite Links:**
- `/start club_123` ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç –∫ –∫–ª—É–±—É –ø–æ—Å–ª–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- `/start group_456` ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç –∫ –≥—Ä—É–ø–ø–µ

---

#### 2. Telegram Chat Integration üí¨
**–°—Ç–∞—Ç—É—Å:** Not Started
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–≤—è–∑—å –∫–ª—É–±–æ–≤/–≥—Ä—É–ø–ø —Å Telegram —á–∞—Ç–∞–º–∏

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ü—Ä–∏–≤—è–∑–∫–∞ –∫–ª—É–±–∞/–≥—Ä—É–ø–ø—ã –∫ Telegram –≥—Ä—É–ø–ø–µ/—Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–µ
- –ü–æ–ª—è: `Club.telegram_chat_id`, `Group.telegram_chat_id`
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

#### 3. Avatar Support üë§
**–°—Ç–∞—Ç—É—Å:** Not Started
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–≤–∞—Ç–∞—Ä–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø

**User Avatar:**
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∞–≤–∞—Ç–∞—Ä–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
- –ü–æ–ª–µ: `User.photo` (—É–∂–µ –µ—Å—Ç—å)
- –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –≤ WebApp —á–µ—Ä–µ–∑ Telegram File API

**Group/Club Avatar:**
- –ó–∞–≥—Ä—É–∑–∫–∞/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤–∞—Ç–∞—Ä–∫–∏ –¥–ª—è –≥—Ä—É–ø–ø –∏ –∫–ª—É–±–æ–≤
- –ü–æ–ª—è: `Club.photo`, `Group.photo` (—É–∂–µ –µ—Å—Ç—å)

---

### P1 - –í–∞–∂–Ω–æ (Should Have)

#### 4. GPX Route Links üó∫Ô∏è
**–°—Ç–∞—Ç—É—Å:** Not Started
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Å—ã–ª–æ–∫ –Ω–∞ GPX —Ñ–∞–π–ª—ã —Å –º–∞—Ä—à—Ä—É—Ç–∞–º–∏

**–î–µ—Ç–∞–ª–∏:** –ë—É–¥–µ—Ç –æ–±—Å—É–∂–¥–∞—Ç—å—Å—è –ø–æ–∑–∂–µ

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 2025-12-18 - Bug Fixes & Features (PLAN_11)
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ—à–ª—ã—Ö –¥–∞—Ç –≤ date picker
- ‚úÖ –ò–∫–æ–Ω–∫–∞ trail/mountain –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π (‚õ∞Ô∏è)
- ‚úÖ –ü–æ–∫–∞–∑ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π –≥—Ä—É–ø–ø—ã (—É–±—Ä–∞–ª–∏ `.slice(0, 3)`)
- ‚úÖ –ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (+ –∏ ‚úì –≤ –∫—Ä—É–∂–æ—á–∫–∞—Ö)
- ‚úÖ –†–µ–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`/api/users/me/stats`)
- ‚úÖ –ò–∫–æ–Ω–∫–∏ —Å–ø–æ—Ä—Ç–æ–≤ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
- ‚úÖ –ú–µ—Ç–∫–∞ "–û—Ä–≥" –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤ –≤ –ø–æ–ø–∞–ø–∞—Ö
- ‚úÖ –°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –ø–æ–ø–∞–ø–∞—Ö
- ‚úÖ City field –¥–æ–±–∞–≤–ª–µ–Ω –≤ –º–æ–¥–µ–ª–∏ (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- ‚úÖ Pydantic v2 ConfigDict –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞

### 2025-12-17 - P0 Bug Fixes
- ‚úÖ UUID validation (—É–±—Ä–∞–ª–∏ parseInt)
- ‚úÖ Duplicate fields (—É–±—Ä–∞–ª–∏ spread operators)
- ‚úÖ Group context –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- ‚úÖ City optional —Å fallback –Ω–∞ user location
- ‚úÖ Join/members endpoints –¥–ª—è –∫–ª—É–±–æ–≤ –∏ –≥—Ä—É–ø–ø

### 2025-12-15 - Core Refactoring
- ‚úÖ Phase 1-5: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ routers, schemas, models
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–µ–π –º–æ–¥–µ–ª–µ–π –∑–∞–≤–µ—Ä—à–µ–Ω–∞

---

## üìã –ë—ç–∫–ª–æ–≥ (Future)

### Database & Architecture
- **Cascades & –ø—Ä–∞–≤–∏–ª–∞ —É–¥–∞–ª–µ–Ω–∏—è** - –Ω—É–∂–Ω–æ –ø—Ä–æ–¥—É–º–∞—Ç—å –ª–æ–≥–∏–∫—É –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–ª—É–±–æ–≤/–≥—Ä—É–ø–ø/–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
- **Indexes** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (–µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è)

### Features (Low Priority)
- City Selector UI (–ø–æ–∫–∞ –Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ, —Ç–æ–ª—å–∫–æ Almaty)
- Paid Activities & Clubs (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ MVP)
- Phone number –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

---

## üöÄ –ü–ª–∞–Ω –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ—Å—Å–∏–∏

### –°–µ—Å—Å–∏—è 1
1. **P0:** Telegram Bot Onboarding (—Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç)
2. **P0:** Telegram Chat Integration

### –°–µ—Å—Å–∏—è 2
3. **P0:** Avatar Support (users & groups)
4. **P1:** GPX Route Links (–æ–±—Å—É–¥–∏—Ç—å –¥–µ—Ç–∞–ª–∏)

---

## üìù –ó–∞–º–µ—Ç–∫–∏

- Default –≥–æ—Ä–æ–¥: **Almaty** (–¥–ª—è MVP)
- –û–Ω–±–æ—Ä–¥–∏–Ω–≥: **—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞** (WebApp onboarding –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- Preferred sports: —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ **JSON string** –≤ –ë–î
- City field: –¥–æ–±–∞–≤–ª–µ–Ω –≤ –º–æ–¥–µ–ª–∏, –Ω–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-12-18
**–ê–≤—Ç–æ—Ä:** Claude Sonnet 4.5
